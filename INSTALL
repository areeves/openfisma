=======================================================================
OpenFISMA INSTALLATION INSTRUCTIONS
=======================================================================

This quickstart guide is intended to help you set up your own instance 
of OpenFISMA. The guide assumes that you are familiar with basic server 
concepts such as installing packages and setting permissions.

Note: This guide does not cover any security best-practices recommended 
when setting up OpenFISMA. If you are setting up a production server, 
please contact us for recommendations on setting up a secure site.

1.0 Software Pre-Requisites
-----------------------------------------------------------------------
You must have the following software installed before proceeding with
the installation of OpenFISMA.

* Apache 2 or greater
* PHP 5.2.0 or greater
* MySQL 5 or greater
* MySQL module for PHP (php-mysql)
* XML module for PHP (php-xml)
Optional --> LDAP module for PHP (php-ldap)

NOTE: CentOS requires the use the Testing Repository to utilize the 
latest version of PHP 5.2
$ rpm --import http://dev.centos.org/centos/RPM-GPG-KEY-CentOS-testing
$ cd /etc/yum.repos.d
$ wget http://dev.centos.org/centos/5/CentOS-Testing.repo
$ yum --disablerepo=* --enablerepo=c5-testing install php php-mysql \ 
php-xml php-ldap
Packages Needed: httpd, php, php-mysql, php-xml, php-ldap, mysql-server

You will need to install these dependencies before installing OpenFISMA. 
Installing these programs is beyond the scope of this quick start guide.

2.0 OpenFISMA Setup
-----------------------------------------------------------------------
Create a directory for OpenFISMA
 $ mkdir /opt/openfisma

Change into the new directory
 $ cd /opt/openfisma

Download the latest copy of OpenFISMA
 $ wget http://downloads.sourceforge.net/openfisma/openfisma-x.x.x.tgz

Unzip the files you just downloaded
 $ tar -xvf openfisma-x.x.x.tgz

You should now have a directory structure which looks like the following
  > application - folder that holds OpenFISMA application 
  > public      - public folder or document root for webserver
  > library     - third party modules used by OpenFISMA
  > data        - holds log files and other data created by OpenFISMA
  > scripts     - holds command line tools related to OpenFISMA

Next you will need to tell Apache where the public directory of OpenFISMA 
resides. Apache configuration is different on almost all flavors of unix 
but the configuration file below should only require minimal changes to get 
you up and running. You will need to customize the server name to the 
appropriate name and validate that the path for the error logs is correct. 

# Virtual Host for serving access to OpenFISMA
NameVirtualHost *:80

<VirtualHost *:80>
   # EDIT THIS ENTRY!
   # Hostname and port that the server uses to identify itself
   # ServerName fully-qualified-domain-name[:port]
   ServerName openfisma.example.gov

   # Instructs apache to remove Trace and Track messages from the
   # header response.
   RewriteEngine on
   RewriteCond %{REQUEST_METHOD} ^TRAC(E|K)
   RewriteRule .* - [F]
   TraceEnable off

   # Sets the Document Root for apache to serve files
   DocumentRoot "/opt/openfisma/public"

   # Sets the permissions on the document root directory
   <Directory "/opt/openfisma/public">
     <LimitExcept GET POST>
        deny from all
     </LimitExcept>
    Order allow,deny
    allow from all

    # Allow Options and php_admin flags to be specified in .htaccess
    # files which override any settings defined here
    AllowOverride FileInfo Options	

	# Instructs Apache to (1) follow symbolic links if owners match          
	# (required for RewriteEngine), (2) not list directory contents, 
	# (3) not follow symbolic links, (4) disables server side includes, 
	# (5) disables content negotiation, and (6) disables execution of 
	# CGI scripts
    Options +SymLinksIfOwnerMatch -Indexes -FollowSymLinks -Includes -Multiviews -ExecCGI

    </Directory>
    
    # sets the name of the file to which the server will log any errors 
    # it encounters, this may need to be changed depending on os type,
    # here is an example for redhat: /var/log/httpd/openfisma-error.log 
	# may need to be set to /var/log/httpd/openfisma-error.log depending on OS type

    ErrorLog /var/log/apache2/openfisma-error.log
    # sets the name of the file to which the server will log information to
    CustomLog /var/log/apache2/openfisma-access.log common

    <IfModule mod_php5.c>
        # Disables allow_url_fopen
        php_admin_flag allow_url_fopen Off
        # Disables allow_url_include
        php_admin_flag allow_url_include Off
        # Enable PHP stealth mode
        php_admin_flag expose_php Off
    </IfModule>
    
</VirtualHost>
  
The following files and directories need to be writeable for the 
installation script to run. 

    /opt/openfisma/application/config/
	/opt/openfisma/application/models/generated
    /opt/openfisma/data

To accomplish this we will run the following commands.

   $ chmod 777 -R /opt/openfisma/application/config
   $ chmod 777 -R /opt/openfisma/application/models/generated
   $ chmod 777 -R /opt/openfisma/data
  
If you have just installed mysql, you will need to set a password for
the root account, OpenFISMA requires you set a root password on the
database before it installs. Example of how to do this below:

	$ mysql -u root mysql
	mysql> SET PASSWORD FOR root@localhost=PASSWORD('ubbersecretpassword');
  
If all has gone well, you will be able to run the installation script
from your browser at http://<server_name>/. Follow the wizard through
the installation steps.

2.1 Email Notification Setting
----------------------------------------------------------------------------
To enable the capability of automated email notification, it's necessary to 
create a cronjob to the /scripts/cronjobs/FismaNotify.php and ECDNotifier.php. 

For example:
# Enable OpenFISMA Email alerts and run the script every 5 minutes
* * * * *  /opt/openfisma/scripts/cronjobs/FismaNotify.php >> /tmp/out 2>&1
# Enable OpenFISMA Overdue alerts and run the script every 5 minutes
<<<<<<< .working
* * * * *  /opt/openfisma/scripts/cronjobs/ECDNotifier.php >> /tmp/out 2>&1
=======
* * * * *  /opt/openfisma/scripts/cronjobs/ECDNotifier.php >> /tmp/out 2>&1>>>>>>> .merge-right.r2381
