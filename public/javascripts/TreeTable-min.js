YAHOO.namespace("fisma.TreeTable");YAHOO.fisma.TreeTable.treeRoot;YAHOO.fisma.TreeTable.defaultDisplayLevel=2;YAHOO.fisma.TreeTable.render=function(b,n){if(YAHOO.lang.isUndefined(YAHOO.fisma.TreeTable.treeRoot)){YAHOO.fisma.TreeTable.treeRoot=n}var m=document.getElementById(b);for(var a in n){var d=n[a];var e=m.insertRow(m.rows.length);e.id=d.nickname;var l=m.insertRow(m.rows.length);l.id=d.nickname+"2";var h=e.insertCell(0);d.expanded=(d.level<YAHOO.fisma.TreeTable.defaultDisplayLevel-1);var k=d.expanded?d.single_ontime:d.all_ontime;var g=d.expanded?d.single_overdue:d.all_overdue;d.hasOverdue=YAHOO.fisma.TreeTable.arraySum(g)>0;needsLink=d.children.length>0;linkOpen=(needsLink?"<a href='#' onclick='YAHOO.fisma.TreeTable.toggleNode(\""+d.nickname+"\")'>":"");linkClose=needsLink?"</a>":"";linkDivClass=needsLink?" link":"";controlImage=d.expanded?"minus.png":"plus.png";control=needsLink?'<img class="control" id="'+d.nickname+'Img" src="/images/'+controlImage+'">':'<img class="control" id="'+d.nickname+'Img" src="/images/leaf_node.png">';h.innerHTML='<div class="treeTable'+d.level+linkDivClass+'">'+linkOpen+control+'<img class="icon" src="/images/'+d.orgType+'.png">'+d.label+"<br><i>"+d.orgTypeLabel+"</i>"+linkClose+"</div>";var f=1;for(var j in k){count=k[j];cell=e.insertCell(f++);if(j=="CLOSED"||j=="TOTAL"){cell.className="noDueDate"}else{cell.className="onTime"}YAHOO.fisma.TreeTable.updateCellCount(cell,count,d.id,j,"ontime")}for(var j in g){count=g[j];cell=l.insertCell(l.childNodes.length);cell.className="overdue";YAHOO.fisma.TreeTable.updateCellCount(cell,count,d.id,j,"overdue")}e.style.display="none";l.style.display="none";if(d.level<YAHOO.fisma.TreeTable.defaultDisplayLevel){e.style.display="";if(d.hasOverdue){e.childNodes[0].rowSpan="2";e.childNodes[e.childNodes.length-2].rowSpan="2";e.childNodes[e.childNodes.length-1].rowSpan="2";l.style.display=""}}if(d.children.length>0){YAHOO.fisma.TreeTable.render(b,d.children)}}};YAHOO.fisma.TreeTable.toggleNode=function(a){node=YAHOO.fisma.TreeTable.findNode(a,YAHOO.fisma.TreeTable.treeRoot);if(node.expanded){YAHOO.fisma.TreeTable.collapseNode(node,true);YAHOO.fisma.TreeTable.hideSubtree(node.children)}else{YAHOO.fisma.TreeTable.expandNode(node);YAHOO.fisma.TreeTable.showSubtree(node.children,false)}};YAHOO.fisma.TreeTable.expandNode=function(f,b){f.ontime=f.single_ontime;f.overdue=f.single_overdue;f.hasOverdue=YAHOO.fisma.TreeTable.arraySum(f.overdue)>0;var a=document.getElementById(f.nickname);var d=1;for(c in f.ontime){count=f.ontime[c];YAHOO.fisma.TreeTable.updateCellCount(a.childNodes[d],count,f.id,c,"ontime");d++}var e=document.getElementById(f.nickname+"2");if(f.hasOverdue){var d=0;for(c in f.overdue){count=f.overdue[c];YAHOO.fisma.TreeTable.updateCellCount(e.childNodes[d],count,f.id,c,"overdue");d++}}else{a.childNodes[0].rowSpan="1";a.childNodes[a.childNodes.length-2].rowSpan="1";a.childNodes[a.childNodes.length-1].rowSpan="1";e.style.display="none"}if(f.children.length>0){document.getElementById(f.nickname+"Img").src="/images/minus.png"}f.expanded=true;if(b&&f.children.length>0){YAHOO.fisma.TreeTable.showSubtree(f.children,false);for(var g in f.children){YAHOO.fisma.TreeTable.expandNode(f.children[g],true)}}};YAHOO.fisma.TreeTable.collapseNode=function(f,b){f.ontime=f.all_ontime;f.overdue=f.all_overdue;f.hasOverdue=YAHOO.fisma.TreeTable.arraySum(f.overdue)>0;var a=document.getElementById(f.nickname);var d=1;for(c in f.ontime){count=f.ontime[c];YAHOO.fisma.TreeTable.updateCellCount(a.childNodes[d],count,f.id,c,"ontime");d++}var e=document.getElementById(f.nickname+"2");if(b&&f.hasOverdue){a.childNodes[0].rowSpan="2";a.childNodes[a.childNodes.length-2].rowSpan="2";a.childNodes[a.childNodes.length-1].rowSpan="2";e.style.display="";var d=0;for(c in f.all_overdue){count=f.all_overdue[c];YAHOO.fisma.TreeTable.updateCellCount(e.childNodes[d],count,f.id,c,"overdue");d++}}if(f.children.length>0){YAHOO.fisma.TreeTable.hideSubtree(f.children)}document.getElementById(f.nickname+"Img").src="/images/plus.png";f.expanded=false};YAHOO.fisma.TreeTable.hideSubtree=function(a){for(nodeId in a){node=a[nodeId];ontimeRow=document.getElementById(node.nickname);ontimeRow.style.display="none";overdueRow=document.getElementById(node.nickname+"2");overdueRow.style.display="none";if(node.children.length>0){YAHOO.fisma.TreeTable.collapseNode(node,false);YAHOO.fisma.TreeTable.hideSubtree(node.children)}}};YAHOO.fisma.TreeTable.showSubtree=function(b,a){for(nodeId in b){node=b[nodeId];if(a&&node.children.length>0){YAHOO.fisma.TreeTable.expandNode(node);YAHOO.fisma.TreeTable.showSubtree(node.children,true)}ontimeRow=document.getElementById(node.nickname);ontimeRow.style.display="";overdueRow=document.getElementById(node.nickname+"2");if(node.hasOverdue){ontimeRow.childNodes[0].rowSpan="2";ontimeRow.childNodes[ontimeRow.childNodes.length-2].rowSpan="2";ontimeRow.childNodes[ontimeRow.childNodes.length-1].rowSpan="2";overdueRow.style.display=""}}};YAHOO.fisma.TreeTable.collapseAll=function(){for(nodeId in YAHOO.fisma.TreeTable.treeRoot){node=YAHOO.fisma.TreeTable.treeRoot[nodeId];YAHOO.fisma.TreeTable.collapseNode(node,true);YAHOO.fisma.TreeTable.hideSubtree(node.children)}};YAHOO.fisma.TreeTable.expandAll=function(){for(nodeId in YAHOO.fisma.TreeTable.treeRoot){node=YAHOO.fisma.TreeTable.treeRoot[nodeId];YAHOO.fisma.TreeTable.expandNode(node,true)}};YAHOO.fisma.TreeTable.findNode=function(e,b){for(var d in b){node=b[d];if(node.nickname==e){return node}else{if(node.children.length>0){var a=YAHOO.fisma.TreeTable.findNode(e,node.children);if(a!=false){return a}}}}return false};YAHOO.fisma.TreeTable.arraySum=function(b){var e=0;for(var d in b){e+=b[d]}return e};YAHOO.fisma.TreeTable.updateCellCount=function(a,f,d,b,g){if(!a.hasChildNodes()){if(f>0){var e=document.createElement("a");e.href=YAHOO.fisma.TreeTable.makeLink(d,b,g);e.appendChild(document.createTextNode(f));a.appendChild(e)}else{a.appendChild(document.createTextNode("-"))}}else{if(a.firstChild.hasChildNodes()){if(f>0){a.firstChild.firstChild.nodeValue=f}else{a.removeChild(a.firstChild);a.appendChild(document.createTextNode("-"))}}else{if(f>0){a.removeChild(a.firstChild);var e=document.createElement("a");e.href=YAHOO.fisma.TreeTable.makeLink(d,b,g);e.appendChild(document.createTextNode(f));a.appendChild(e)}else{a.firstChild.nodeValue="-"}}}};YAHOO.fisma.TreeTable.makeLink=function(b,a,e){var d="/panel/remediation/sub/search/ontime/"+e+"/orgId/"+b+"/status/"+escape(a);return d};YAHOO.fisma.TreeTable.exportTable=function(b){var a="/remediation/summary-data/format/"+b+YAHOO.fisma.TreeTable.listExpandedNodes(YAHOO.fisma.TreeTable.treeRoot,"");document.location=a};YAHOO.fisma.TreeTable.listExpandedNodes=function(b,a){for(var e in b){var d=b[e];if(d.expanded){a+="/e/"+d.id;a=YAHOO.fisma.TreeTable.listExpandedNodes(d.children,a)}else{a+="/c/"+d.id}}return a};YAHOO.fisma.TreeTable.exportExcel=function(){YAHOO.fisma.TreeTable.exportTable("xls")};YAHOO.fisma.TreeTable.exportPdf=function(){YAHOO.fisma.TreeTable.exportTable("pdf")};