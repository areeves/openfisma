Fisma.Email=function(){return{panelElement:null,showRecipientDialog:function(){if(Fisma.Email.panelElement!==null&&Fisma.Email.panelElement instanceof YAHOO.widget.Panel){Fisma.Email.panelElement.removeMask();Fisma.Email.panelElement.destroy();Fisma.Email.panelElement=null}var c=document.createElement("div");var g=document.createElement("p");var b=document.createTextNode("* Target E-mail Address:");g.appendChild(b);c.appendChild(g);var e=document.createElement("input");e.id="testEmailRecipient";e.name="recipient";c.appendChild(e);var f=document.createElement("div");f.style.height="10px";c.appendChild(f);var a=document.createElement("input");a.type="button";a.id="dialogRecipientSendBtn";a.style.marginLeft="10px";a.value="Send";c.appendChild(a);var d={width:"260px",modal:false};Fisma.Email.panelElement=Fisma.HtmlPanel.showPanel("Test E-mail Configuration",c.innerHTML,null,d);document.getElementById("dialogRecipientSendBtn").onclick=Fisma.Email.sendTestEmail},sendTestEmail:function(){if(document.getElementById("testEmailRecipient").value===""){var e="Recipient is required.";var a={zIndex:10000};Fisma.Util.showAlertDialog(e,a);document.getElementById("testEmailRecipient").focus();return false}var d=document.getElementById("testEmailRecipient").value;var c=document.getElementById("email_config");c.elements.recipient.value=d;var b=document.getElementById("sendTestEmail");spinner=new Fisma.Spinner(b.parentNode);spinner.show();YAHOO.util.Connect.setForm(c);YAHOO.util.Connect.asyncRequest("POST","/config/test-email-config/format/json",{success:function(g){var f=YAHOO.lang.JSON.parse(g.responseText);message(f.msg,f.type,true);spinner.hide()},failure:function(g){var f="Failed to send test mail: "+g.statusText;Fisma.Util.showAlertDialog(f);spinner.hide()}},null);if(Fisma.Email.panelElement!==null&&Fisma.Email.panelElement instanceof YAHOO.widget.Panel){Fisma.Email.panelElement.hide();Fisma.Email.panelElement.destroy();Fisma.Email.panelElement=null}return true}}}();