(function(){var a=YAHOO.lang,b=Fisma.PersistentStorage,c=function(d,e){this._model=d;this._storage=new Fisma.PersistentStorage("Fisma.Search.TablePreferences");this._localStorage=new Fisma.Storage("Fisma.Search.TablePreferences.Local");this._state=null;Fisma.Storage.onReady(function(){var f=this._storage.get(this._model);this._state=a.isObject(e)?e:{};if(a.isObject(f)){this._state=a.merge(f,this._state)}},this,true)};c.prototype={getColumnVisibility:function(d,e){this._stateReady();if(a.isValue(this._state.columnVisibility[d])){return this._state.columnVisibility[d]?true:false}return a.isValue(e)&&e?true:false},setColumnVisibility:function(d,e){this._stateReady();this._state.columnVisibility[d]=e;this._storage.set(this._model,this._state)},getSort:function(){var d=this._localStorage.get(this._model);return a.isObject(d)&&a.isObject(d.sort)?d.sort:null},setSort:function(e,d){var f=this._localStorage.get(this._model);f=a.isObject(f)?f:{};f.sort={column:e,dir:d};this._localStorage.set(this._model,f)},getPage:function(){var d=this._localStorage.get(this._model);return a.isObject(d)&&a.isNumber(d.page)?d.page:null},setPage:function(e){var d=this._localStorage.get(this._model);d=a.isObject(d)?d:{};d.page=e;this._localStorage.set(this._model,d)},persist:function(f){var d=this._model,e=this._storage;e.set(d,e.get(d));e.sync([d],f)},_stateReady:function(){if(this._state===null){throw"Attempting to use storage engine before it is ready."}if(typeof(this._state.columnVisibility)==="undefined"){this._state.columnVisibility={}}}};Fisma.Search.TablePreferences=c})();