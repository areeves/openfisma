var Fisma={};$P=new PHP_JS();String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};var readyFunc=function(){var c=document.getElementById("zfdebug_yui_logging_tab");if(c){var f=new YAHOO.widget.LogReader(c,{draggable:false,verboseOutput:false,width:"95%"});f.hideCategory("info");f.hideCategory("time");f.hideCategory("window");f.hideCategory("iframe")}var h=YAHOO.util.Selector.query(".date");for(var b=0;b<h.length;b++){YAHOO.util.Event.on(h[b].getAttribute("id")+"_show","click",callCalendar,h[b].getAttribute("id"))}var a=function(){if(document.getElementById("remediationSearchAging")){var l=document.getElementById("remediationSearchAging").value.trim()}else{return}var j=document.getElementById("created_date_begin");var k=document.getElementById("created_date_end");if(l=="0"){j.disabled=false;k.disabled=false;document.getElementById("show1").disabled=false;document.getElementById("show2").disabled=false}else{j.disabled=true;k.disabled=true;j.value="";k.value="";document.getElementById("show1").disabled=true;document.getElementById("show2").disabled=true}};YAHOO.util.Event.on("remediationSearchAging","change",a);a();var g=function(){if(document.getElementById("created_date_begin")&&document.getElementById("created_date_end")){var k=document.getElementById("created_date_begin").value.trim();var j=document.getElementById("created_date_end").value.trim()}else{return}if(k!=""||j!=""){document.getElementById("remediationSearchAging").disabled=true}else{document.getElementById("remediationSearchAging").disabled=false}};YAHOO.util.Event.on("created_date_begin","change",g);YAHOO.util.Event.on("created_date_end","change",g);g();var d=function(){if(document.getElementById("encrypt")){var k=document.getElementById("encrypt")}else{return}var j=k.value.trim();if(j=="sha256"){k.style.display=""}else{k.style.display="none"}};YAHOO.util.Event.on("encrypt","change",d);d();YAHOO.util.Event.on("function_screen","change",search_function);search_function();YAHOO.util.Event.on("add_function","click",function(){var j=new YAHOO.util.Selector.query("#availableFunctions option");for(var k=0;k<j.length;k++){if(j[k].selected==true){document.getElementById("existFunctions").appendChild(j[k])}}return false});YAHOO.util.Event.on("remove_function","click",function(){var j=YAHOO.util.Selector.query("#existFunctions option");for(var k=0;k<j.length;k++){if(j[k].selected==true){document.getElementById("availableFunctions").appendChild(j[k])}}return false});YAHOO.util.Event.on(YAHOO.util.Selector.query("form[name=assign_right]"),"submit",function(){var j=YAHOO.util.Selector.query("#existFunctions option");for(var k=0;k<j.length;k++){j[k].selected=true}});YAHOO.util.Event.on("searchAsset","click",searchAsset);YAHOO.util.Event.on("search_product","click",searchProduct);YAHOO.util.Event.on(YAHOO.util.Selector.query(".confirm"),"click",function(){var j="DELETING CONFIRMATION!";if(confirm(j)==true){return true}return false});asset_detail();getProdId()};function search_function(){var d=YAHOO.util.Selector.query("select[name=function_screen]");if(d==""){return}var j=name="";var c=YAHOO.util.Selector.query("select[name=function_screen] option");for(var f=0;f<c.length;f++){if(c[f].selected==true){name=c[f].text}}if(""!=name){j+="/screen_name/"+name}var b=YAHOO.util.Selector.query("#existFunctions option");var h="";for(var f=0;f<b.length;f++){if(f==0){h+=b[f].value}else{h+=","+b[f].value}}var a=document.getElementById("function_screen").getAttribute("url")+"/do/availableFunctions"+j+"/existFunctions/"+h;var g=YAHOO.util.Connect.asyncRequest("GET",a,{success:function(k){document.getElementById("availableFunctions").parentNode.innerHTML='<select style="width: 250px;" name="availableFunctions" id="availableFunctions" size="20" multiple="">'+k.responseText+"</select>"},failure:handleFailure})}var handleFailure=function(a){alert("error")};function getProdId(){var a=document.getElementById("productId");YAHOO.util.Event.on(a,"change",function(){document.getElementById("productId").value=a.value})}var searchProduct=function(){var c=document.getElementById("search_product");var b=c.getAttribute("url");var a=YAHOO.util.Selector.query("input.product");for(var d=0;d<a.length;d++){if(a[d].value!=undefined&&a[d].value!=""){b+="/"+a[d].name+"/"+a[d].value}}YAHOO.util.Connect.asyncRequest("GET",b,{success:function(f){document.getElementById("productId").parentNode.innerHTML=f.responseText;document.getElementById("productId").style.width="400px";getProdId()},failure:handleFailure})};var searchAsset=function(){var b=new YAHOO.util.Element("orgSystemId");if(b.get("id")==undefined){return}var f=b.get("value");var g="";if(0!=parseInt(f)){g+="/system_id/"+f}var d=YAHOO.util.Selector.query("input.assets");for(var c=0;c<d.length;c++){if(d[c].value!=undefined&&d[c].value!=""){g+="/"+d[c].name+"/"+d[c].value}}var a=document.getElementById("orgSystemId").getAttribute("url")+g;YAHOO.util.Connect.asyncRequest("GET",a,{success:function(k){document.getElementById("assetId").options.length=0;var h=YAHOO.lang.JSON.parse(k.responseText);h=h.table.records;for(var j=0;j<h.length;j++){document.getElementById("assetId").options.add(new Option(h[j].name,h[j].id))}},failure:handleFailure})};function asset_detail(){YAHOO.util.Event.on("assetId","change",function(){var a=this.getAttribute("url")+this.value;YAHOO.util.Connect.asyncRequest("GET",a,{success:function(b){document.getElementById("asset_info").innerHTML=b.responseText},failure:handleFailure})})}function message(d,b,a){a=a||false;d=$P.stripslashes(d);if(document.getElementById("msgbar")){var c=document.getElementById("msgbar")}else{return}if(c.innerHTML&&!a){c.innerHTML=c.innerHTML+d}else{c.innerHTML=d}c.style.fontWeight="bold";if(b=="warning"){c.style.color="red";c.style.borderColor="red";c.style.backgroundColor="pink"}else{c.style.color="green";c.style.borderColor="green";c.style.backgroundColor="lightgreen"}c.style.display="block"}function toggleSearchOptions(b){var a=document.getElementById("advanced_searchbox");if(a.style.display=="none"){a.style.display="";b.value="Basic Search"}else{a.style.display="none";b.value="Advanced Search"}}function showJustification(){if(document.getElementById("ecd_justification")){document.getElementById("ecd_justification").style.display=""}}function addBookmark(d,c){if(window.sidebar){window.sidebar.addPanel(c.title,c.href,"")}else{if(window.opera){var b=document.createElement("A");b.rel="sidebar";b.target="_search";b.title=c.title;b.href=c.href;b.click()}else{if(document.all){window.external.AddFavorite(c.href,c.title)}else{alert("Your browser does not support automatic bookmarks. Please try to bookmark this page manually instead.")}}}}function switchYear(d){if(!isFinite(d)){d=0}var f=document.getElementById("gen_shortcut");var c=f.getAttribute("year");c=Number(c)+Number(d);f.setAttribute("year",c);var a=f.getAttribute("url")+c+"/";var b=YAHOO.util.Selector.query("#gen_shortcut span:nth-child(1)");b[0].innerHTML=c;b[0].parentNode.setAttribute("href",a);b[1].parentNode.setAttribute("href",a+"q/1/");b[2].parentNode.setAttribute("href",a+"q/2/");b[3].parentNode.setAttribute("href",a+"q/3/");b[4].parentNode.setAttribute("href",a+"q/4/")}function form_confirm(g,f){var j=false;elements=YAHOO.util.Selector.query("[name*='finding']");for(var b=0;b<elements.length;b++){var h=elements[b].tagName.toUpperCase();if(h=="INPUT"){var a=elements[b].type;if(a=="text"||a=="password"){var c=elements[b].getAttribute("_value");if(typeof(c)=="undefined"){c=""}if(c!=elements[b].value){}}if(a=="checkbox"||a=="radio"){var c=elements[b].checked?"on":"off";if(c!=elements[b].getAttribute("_value")){j=true}}}else{if(h=="SELECT"){var c=elements[b].getAttribute("_value");if(typeof(c)=="undefined"){c=""}if(c!=elements[b].options[elements[b].selectedIndex].value){j=true}}else{if(h=="TEXTAREA"){var c=elements[b].getAttribute("_value");if(typeof(c)=="undefined"){c=""}var d=elements[b].value?elements[b].value:elements[b].innerHTML;if(c!=d){j=true}}}}}if(j){if(confirm('WARNING: You have unsaved changes on the page. If you continue, these changes will be lost. If you want to save your changes, click "Cancel" now and then click "Save Changes".')){return true}else{return false}}if(confirm("WARNING: You are about to "+f+'. This action cannot be undone. Please click "Ok" to confirm your action or click "Cancel" to stop.')){return true}return false}function dump(a){var b=""+a;for(i in a){if("function"!=typeof(a[i])){b+=i+" : "+a[i]+"\n"}}alert(b)}var e=YAHOO.util.Event;e.onDOMReady(readyFunc);function callCalendar(a,b){showCalendar(b,b+"_show")}function showCalendar(f,c){var l=YAHOO.util.Event,h=YAHOO.util.Dom,j,g;var k=h.get(c);var j;var g;if(!j){function d(){h.get(f).value="";a()}function a(){j.hide()}j=new YAHOO.widget.Dialog("container",{visible:false,context:[f,"tl","bl"],draggable:true,close:true});j.setHeader("Pick A Date");j.setBody('<div id="cal"></div><div class="clear"></div>');j.render(document.body);dialogEl=document.getElementById("container");dialogEl.style.padding="0px";j.showEvent.subscribe(function(){if(YAHOO.env.ua.ie){j.fireEvent("changeContent")}})}if(!g){g=new YAHOO.widget.Calendar("cal",{iframe:false,hide_blank_weeks:true});g.render();g.selectEvent.subscribe(function(){if(g.getSelectedDates().length>0){var n=g.getSelectedDates()[0];var m=(n.getDate()<10)?"0"+n.getDate():n.getDate();var p=(n.getMonth()+1<10)?"0"+(n.getMonth()+1):(n.getMonth()+1);var o=n.getFullYear();h.get(f).value=o+"-"+p+"-"+m}else{h.get(f).value=""}j.hide();if("finding[currentEcd]"==h.get(f).name){validateEcd()}});g.renderEvent.subscribe(function(){j.fireEvent("changeContent")})}var b=g.getSelectedDates();if(b.length>0){g.cfg.setProperty("pagedate",b[0]);g.render()}j.show()}function updateTimeField(b){var c=document.getElementById(b);var j=document.getElementById(b+"Hour");var k=document.getElementById(b+"Minute");var a=document.getElementById(b+"Ampm");var g=j.value;var f=k.value;var h=a.value;if("PM"==h){g=parseInt(g)+12}g=$P.str_pad(g,2,"0","STR_PAD_LEFT");f=$P.str_pad(f,2,"0","STR_PAD_LEFT");var d=g+":"+f+":00";c.value=d};