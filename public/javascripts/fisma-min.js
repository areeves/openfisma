String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};var readyFunc=function(){var f=YAHOO.util.Selector.query(".date");for(var b=0;b<f.length;b++){YAHOO.util.Event.on(f[b].getAttribute("id")+"_show","click",callCalendar,f[b].getAttribute("id"))}var a=function(){if(document.getElementById("remediationSearchAging")){var j=document.getElementById("remediationSearchAging").value.trim()}else{return}var g=document.getElementById("created_date_begin");var h=document.getElementById("created_date_end");if(j=="0"){g.disabled=false;h.disabled=false;document.getElementById("show1").disabled=false;document.getElementById("show2").disabled=false}else{g.disabled=true;h.disabled=true;g.value="";h.value="";document.getElementById("show1").disabled=true;document.getElementById("show2").disabled=true}};YAHOO.util.Event.on("remediationSearchAging","change",a);a();var d=function(){if(document.getElementById("created_date_begin")&&document.getElementById("created_date_end")){var h=document.getElementById("created_date_begin").value.trim();var g=document.getElementById("created_date_end").value.trim()}else{return}if(h!=""||g!=""){document.getElementById("remediationSearchAging").disabled=true}else{document.getElementById("remediationSearchAging").disabled=false}};YAHOO.util.Event.on("created_date_begin","change",d);YAHOO.util.Event.on("created_date_end","change",d);d();var c=function(){if(document.getElementById("encrypt")){var h=document.getElementById("encrypt")}else{return}var g=h.value.trim();if(g=="sha256"){h.style.display=""}else{h.style.display="none"}};YAHOO.util.Event.on("encrypt","change",c);c();YAHOO.util.Event.on("function_screen","change",search_function);search_function();YAHOO.util.Event.on("add_function","click",function(){var g=new YAHOO.util.Selector.query("#available_functions option");for(var h=0;h<g.length;h++){if(g[h].selected==true){document.getElementById("exist_functions").appendChild(g[h])}}return false});YAHOO.util.Event.on("remove_function","click",function(){var g=YAHOO.util.Selector.query("#exist_functions option");for(var h=0;h<g.length;h++){if(g[h].selected==true){document.getElementById("available_functions").appendChild(g[h])}}return false});YAHOO.util.Event.on(YAHOO.util.Selector.query("form[name=assign_right]"),"submit",function(){var g=YAHOO.util.Selector.query("#exist_functions option");for(var h=0;h<g.length;h++){g[h].selected=true}});YAHOO.util.Event.on("searchAsset","click",searchAsset);YAHOO.util.Event.on("search_product","click",searchProduct);YAHOO.util.Event.on(YAHOO.util.Selector.query(".confirm"),"click",function(){var g="DELETING CONFIRMATION!";if(confirm(g)==true){return true}return false});asset_detail();getProdId()};function search_function(){var f=YAHOO.util.Selector.query("select[name=function_screen]");if(f==""){return}var j=name="";var d=YAHOO.util.Selector.query("select[name=function_screen] option");for(var g=0;g<d.length;g++){if(d[g].selected==true){name=d[g].text}}if(""!=name){j+="/screen_name/"+name}var c=YAHOO.util.Selector.query("#exist_functions option");var a="";for(var g=0;g<c.length;g++){if(g==0){a+=c[g].value}else{a+=","+c[g].value}}var b=document.getElementById("function_screen").getAttribute("url")+"/do/available_functions"+j+"/exist_functions/"+a;var h=YAHOO.util.Connect.asyncRequest("GET",b,{success:function(k){document.getElementById("available_functions").parentNode.innerHTML='<select style="width: 250px;" name="available_functions" id="available_functions" size="20" multiple="">'+k.responseText+"</select>"},failure:handleFailure})}var handleFailure=function(a){alert("error")};function upload_evidence(){if(!form_confirm(document.finding_detail,"Upload Evidence")){return false}document.finding_detail.enctype="multipart/form-data";panel("Upload Evidence",document.finding_detail,"/remediation/upload-form");return false}function ev_deny(d){if(!form_confirm(document.finding_detail,"deny the evidence")){return false}var c=document.createElement("div");var f=document.createElement("p");f.appendChild(document.createTextNode("Comments:"));c.appendChild(f);var b=document.createElement("textarea");b.rows=5;b.cols=60;b.id="dialog_comment";b.name="comment";c.appendChild(b);var g=document.createElement("div");g.style.height="20px";c.appendChild(g);var a=document.createElement("input");a.type="button";a.id="dialog_continue";a.value="Continue";c.appendChild(a);panel("Evidence Denial",document.finding_detail,"",c.innerHTML);document.getElementById("dialog_continue").onclick=function(){var j=d;if(document.all){var k=document.getElementById("dialog_comment").innerHTML}else{var k=document.getElementById("dialog_comment").value}j.elements.comment.value=k;j.elements.decision.value="DENIED";var h=document.createElement("input");h.type="hidden";h.name="submit_ea";h.value="DENIED";j.appendChild(h);j.submit()}}function ms_comment(d){if(!form_confirm(document.finding_detail,"deny the mitigation")){return false}var c=document.createElement("div");var f=document.createElement("p");var g=document.createTextNode("Comments:");f.appendChild(g);c.appendChild(f);var a=document.createElement("textarea");a.id="dialog_comment";a.name="comment";a.rows=5;a.cols=60;c.appendChild(a);var h=document.createElement("div");h.style.height="20px";c.appendChild(h);var b=document.createElement("input");b.type="button";b.id="dialog_continue";b.value="Continue";c.appendChild(b);panel("Mitigation Strategy Denial",document.finding_detail,"",c.innerHTML);document.getElementById("dialog_continue").onclick=function(){var k=d;if(document.all){var l=document.getElementById("dialog_comment").innerHTML}else{var l=document.getElementById("dialog_comment").value}k.elements.comment.value=l;k.elements.decision.value="DENIED";var j=document.createElement("input");j.type="hidden";j.name="submit_msa";j.value="DENIED";k.appendChild(j);k.submit()}}function getProdId(){var a=document.getElementById("productId");YAHOO.util.Event.on(a,"change",function(){document.getElementById("productId").value=a.value})}var searchProduct=function(){var c=document.getElementById("search_product");var b=c.getAttribute("url");var a=YAHOO.util.Selector.query("input.product");for(var d=0;d<a.length;d++){if(a[d].value!=undefined&&a[d].value!=""){b+="/"+a[d].name+"/"+a[d].value}}YAHOO.util.Connect.asyncRequest("GET",b,{success:function(f){document.getElementById("productId").parentNode.innerHTML=f.responseText;document.getElementById("productId").style.width="400px";getProdId()},failure:handleFailure})};var searchAsset=function(){var b=new YAHOO.util.Element("orgSystemId");if(b.get("id")==undefined){return}var f=b.get("value");var g="";if(0!=parseInt(f)){g+="/system_id/"+f}var d=YAHOO.util.Selector.query("input.assets");for(var c=0;c<d.length;c++){if(d[c].value!=undefined&&d[c].value!=""){g+="/"+d[c].name+"/"+d[c].value}}var a=document.getElementById("orgSystemId").getAttribute("url")+g;YAHOO.util.Connect.asyncRequest("GET",a,{success:function(k){document.getElementById("assetId").options.length=0;var h=YAHOO.lang.JSON.parse(k.responseText);h=h.table.records;for(var j=0;j<h.length;j++){document.getElementById("assetId").options.add(new Option(h[j].name,h[j].id))}},failure:handleFailure})};function asset_detail(){YAHOO.util.Event.on("assetId","change",function(){var a=this.getAttribute("url")+this.value;YAHOO.util.Connect.asyncRequest("GET",a,{success:function(b){document.getElementById("asset_info").innerHTML=b.responseText},failure:handleFailure})})}function message(c,a){if(document.getElementById("msgbar")){var b=document.getElementById("msgbar")}else{return}b.innerHTML=c;b.style.fontWeight="bold";if(a=="warning"){b.style.color="red"}else{b.style.color="green";b.style.borderColor="green";b.style.backgroundColor="lightgreen"}b.style.display="block"}function toggleSearchOptions(b){var a=document.getElementById("advanced_searchbox");if(a.style.display=="none"){a.style.display="";b.value="Basic Search"}else{a.style.display="none";b.value="Advanced Search"}}function showJustification(){if(document.getElementById("ecd_justification")){document.getElementById("ecd_justification").style.display=""}}function addBookmark(d,c){if(window.sidebar){window.sidebar.addPanel(d,c,"")}else{if(window.opera){var b=document.createElement("A");b.rel="sidebar";b.target="_search";b.title=d;b.href=c;b.click()}else{if(document.all){window.external.AddFavorite(c,d)}}}}function highlight(d,b){if(!b){return true}b=b.split(" ");for(var a in b){keyword=b[a];if(d&&d.hasChildNodes){var c;for(c=0;c<d.childNodes.length;c++){highlight(d.childNodes[c],keyword)}}if(d&&d.nodeType==3){tempNodeVal=d.nodeValue.toLowerCase();tempWordVal=keyword.toLowerCase();if(tempNodeVal.indexOf(tempWordVal)!=-1){pn=d.parentNode;if(pn.className!="highlight"){nv=d.nodeValue;ni=tempNodeVal.indexOf(tempWordVal);before=document.createTextNode(nv.substr(0,ni));docWordVal=nv.substr(ni,keyword.length);after=document.createTextNode(nv.substr(ni+keyword.length));hiwordtext=document.createTextNode(docWordVal);hiword=document.createElement("span");hiword.className="highlight";hiword.appendChild(hiwordtext);pn.insertBefore(before,d);pn.insertBefore(hiword,d);pn.insertBefore(after,d);pn.removeChild(d)}}}}}function removeHighlight(b){if(b.hasChildNodes){var a;for(a=0;a<b.childNodes.length;a++){removeHighlight(b.childNodes[a])}}if(b.nodeType==3){pn=b.parentNode;if(pn.className=="highlight"){prevSib=pn.previousSibling;nextSib=pn.nextSibling;nextSib.nodeValue=prevSib.nodeValue+b.nodeValue+nextSib.nodeValue;prevSib.nodeValue="";b.nodeValue=""}}}function switchYear(d){if(!isFinite(d)){d=0}var f=document.getElementById("gen_shortcut");var c=f.getAttribute("year");c=Number(c)+Number(d);f.setAttribute("year",c);var a=f.getAttribute("url")+c+"/";var b=YAHOO.util.Selector.query("#gen_shortcut span:nth-child(1)");b[0].innerHTML=c;b[0].parentNode.setAttribute("href",a);b[1].parentNode.setAttribute("href",a+"q/1/");b[2].parentNode.setAttribute("href",a+"q/2/");b[3].parentNode.setAttribute("href",a+"q/3/");b[4].parentNode.setAttribute("href",a+"q/4/")}function form_confirm(g,f){var j=false;elements=YAHOO.util.Selector.query("[name*='finding']");for(var b=0;b<elements.length;b++){var h=elements[b].tagName.toUpperCase();if(h=="INPUT"){var a=elements[b].type;if(a=="text"||a=="password"){var c=elements[b].getAttribute("_value");if(typeof(c)=="undefined"){c=""}if(c!=elements[b].value){j=true}}if(a=="checkbox"||a=="radio"){var c=elements[b].checked?"on":"off";if(c!=elements[b].getAttribute("_value")){j=true}}}else{if(h=="SELECT"){var c=elements[b].getAttribute("_value");if(typeof(c)=="undefined"){c=""}if(c!=elements[b].options[elements[b].selectedIndex].value){j=true}}else{if(h=="TEXTAREA"){var c=elements[b].getAttribute("_value");if(typeof(c)=="undefined"){c=""}var d=elements[b].value?elements[b].value:elements[b].innerHTML;if(c!=d){j=true}}}}}if(j){if(confirm('WARNING: You have unsaved changes on the page. If you continue, these changes will be lost. If you want to save your changes, click "Cancel" now and then click "Save Changes".')){return true}}if(confirm("WARNING: You are about to "+f+'. This action cannot be undone. Please click "Ok" to confirm your action or click "Cancel" to stop.')){return true}return false}function dump(a){var b=""+a;for(i in a){if("function"!=typeof(a[i])){b+=i+" : "+a[i]+"\n"}}alert(b)}function panel(f,c,d,b,g){var a=new YAHOO.widget.Panel("panel",{width:"540px",modal:true});a.setHeader(f);a.setBody("Loading...");a.render(c);a.center();a.show();if(d!=""){YAHOO.util.Connect.asyncRequest("GET",d,{success:function(h){h.argument.setBody(h.responseText);h.argument.center();g()},failure:function(h){alert("Failed to load the specified panel.")},argument:a},null)}else{a.setBody(b);a.center()}}var e=YAHOO.util.Event;e.onDOMReady(readyFunc);function callCalendar(a,b){showCalendar(b,b+"_show")}function showCalendar(f,c){var l=YAHOO.util.Event,h=YAHOO.util.Dom,j,g;var k=h.get(c);var j;var g;if(!j){function d(){h.get(f).value="";a()}function a(){j.hide()}j=new YAHOO.widget.Dialog("container",{visible:false,context:[f,"tl","bl"],draggable:true,close:true});j.setHeader("Pick A Date");j.setBody('<div id="cal"></div><div class="clear"></div>');j.render(document.body);dialogEl=document.getElementById("container");dialogEl.style.padding="0px";j.showEvent.subscribe(function(){if(YAHOO.env.ua.ie){j.fireEvent("changeContent")}})}if(!g){g=new YAHOO.widget.Calendar("cal",{iframe:false,hide_blank_weeks:true});g.render();g.selectEvent.subscribe(function(){if(g.getSelectedDates().length>0){var n=g.getSelectedDates()[0];var m=(n.getDate()<10)?"0"+n.getDate():n.getDate();var p=(n.getMonth()+1<10)?"0"+(n.getMonth()+1):(n.getMonth()+1);var o=n.getFullYear();h.get(f).value=o+"-"+p+"-"+m}else{h.get(f).value=""}j.hide();if("finding[currentEcd]"==h.get(f).name){validateEcd()}});g.renderEvent.subscribe(function(){j.fireEvent("changeContent")})}var b=g.getSelectedDates();if(b.length>0){g.cfg.setProperty("pagedate",b[0]);g.render()}j.show()};