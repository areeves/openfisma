============================================================================
OpenFISMA Database Migrations
============================================================================

This folder contains the up and down scripts to control schema changes to 
the database utilized by OpenFISMA. This provides a controllable configuration
management process which can be used to upgrade previous installations
without destroying data. This directory also contains a base.sql file, this
is the full copy of the OpenFISMA database schema and is always up to date
with all up and down scripts. 

Similar to Rails Migrations, the OpenFISMA Database Migrations packages 
standards and tools together to bring order to the usually chaotic process 
of version controlling the data model. Each change to the data model is called
a migration, and each migration consists of a pair of short SQL scripts 
(or patches) called up and down. The up script evolves the schema model 
forward one step, while the down script precisely reverses the effect of the 
up script.

By comparing the existing schema version number with the desired target 
version, a series of scripts can be executed to bring an existing schema 
(and all the data contained therein) to match any other intermediate or 
final schema version.

OpenFISMA comes with two PERL scripts in the /scripts/bin directory used
to test and update the database schema.

Script One: testmigrate.pl
Description: This script is the developer's tool for OpenFISMA migrations. 
It is used to test patches before committing them, and used to update the 
base.sql with the latest application schema and all metadata.

Script Two: migrate.pl
Description: This script migrates the schema named in the schema.cfg file 
(in the same directory as this script) from its existing version to the
version designated on the command line (or the most recent version if not 
specified).

For information about the OpenFISMA migrations policy:
http://docs.google.com/Doc?id=dgznrgjw_15f7wt6cg3

===========================================================================
Instructions for Upgrading an Existing OpenFISMA Installation
===========================================================================

Step One: Update openfisma with the latest files, this is easiest if you 
          have Openfisma under a version controlled environment such as 
          Subversion. By issuing the command svn update, we would bring 
          all files up to the latest copies.

Step Two: Edit /scripts/bin/schema.cfg with the correct database connection 
          information. The following variables need to be edited: dbUser, 
          dbPassword, dbHost, dbSchema, and migrationsDir.

Step Three: Run the migrate.pl script from the command line by issuing 
            ./migrate.pl
