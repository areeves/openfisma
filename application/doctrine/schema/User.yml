User:
    inheritance:
        extends: Poc
        type: column_aggregation
    listeners: [IndexListener, NotificationListener]

    columns:
        password:
            type: string(255)
            extra:
                doNotModify: true
                logicalName: Password
                notify: true
        passwordSalt:
            type: string(10)
            fixed: true
            comment: A randomly generated salt, used to discourage rainbow table attacks against the password database
            extra:
                doNotModify: true
        passwordTs: timestamp
        passwordHistory: string
        hashType:
            type: enum
            values: [md5, sha1, sha224, sha256, sha384, sha512]
        lastRob:
            type: timestamp
            comment: The last time this user digitally accepted the Rules of Behavior

        locked:
            type: boolean
            default: false
            extra:
                notify: true
        lockTs: timestamp
        failureCount:
            type: integer
            default: 0
            comment: How many times the user entered the wrong password before successfully logging in

        lastLoginIp:
            type: string(39)
            Fisma_Doctrine_Validator_Ip: true
        lastLoginTs: timestamp

        searchColumnsPref:
            type: integer
            comment: A bitmask corresponding to visible columns on the search page

        notifyFrequency: integer
        mostRecentNotifyTs: timestamp

        mustResetPassword:
            type: boolean
            default: false

    relations:
        # Roles is a many-to-many relation
        Roles:
            class: Role
            local: userId
            foreign: roleId
            refClass: UserRole

        # Events is a many-to-many relation
        Events:
            class: Event
            local: userId
            foreign: eventId
            refClass: UserEvent

        # Incidents is many-to-many
        Incidents:
            class: User
            local: userId
            foreign: incidentId
            refClass: IrIncidentUser
