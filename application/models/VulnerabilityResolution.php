<?php

/**
 * VulnerabilityResolution
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    ##PACKAGE##
 * @subpackage ##SUBPACKAGE##
 * @author     ##NAME## <##EMAIL##>
 * @version    SVN: $Id: Builder.php 6401 2009-09-24 16:12:04Z guilhermeblanco $
 */
class VulnerabilityResolution extends BaseVulnerabilityResolution
{

    public function preDelete($event)
    {
        $resolutionCount = Doctrine_Query::create()
            ->from('vulnerability')
            ->where('resolutionId = ?', $this->id)
            ->count();

        if ($resolutionCount > 0) {
            throw new Fisma_Zend_Exception_User(
                'This resolution cannot be deleted because it has vulnerabilities assigned to it.'
            );
        }
    }
}
