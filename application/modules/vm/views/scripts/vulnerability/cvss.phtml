<?php if ($this->cvss):?>
    <div class="left">
        <?php
        $baseText = "<p>The base metric group captures the characteristics of a "
        . "vulnerability that are constant with time and across user environments. The "
        . "Access Vector, Access Complexity, and Authentication metrics capture how the "
        . "vulnerability is accessed and whether or not extra conditions are required to "
        . "exploit it. The three impact metrics measure how a vulnerability, if exploited, "
        . "will directly affect an IT asset, where the impacts are independently defined "
        . "as the degree of loss of confidentiality, integrity, and availability. For "
        . "example, a vulnerability could cause a partial loss of integrity and "
        . "availability, but no loss of confidentiality.</p>"; 
        
        $baseTooltip = new Fisma_Yui_Tooltip('base', 'CVSS Base Details', $baseText);
        Fisma_Format_Section::startSection($baseTooltip);
        ?>
            <table class="fisma_crud">
                <tr>
                    <?php 
                    $avTooltip = new Fisma_Yui_Tooltip('AV', 'Access Vector:', 
                    "<p align='center'><b>Access Vector (AV)</b></p>"
                    . "<p>This metric reflects how the vulnerability is exploited.</p> "
                    . "<p><b>Local (L)</b> - A vulnerability exploitable with only local "
                    . "access requires the attacker to have either physical access to the vulnerable "
                    . "system or a local (shell) account. Examples of locally exploitable "
                    . "vulnerabilities are peripheral attacks such as Firewire/USB DMA attacks, and "
                    . "local privilege escalations (e.g., sudo).</p><p><b>Adjacent Network (A)</b> - A "
                    . "vulnerability exploitable with adjacent network access requires the attacker to "
                    . "have access to either the broadcast or collision domain of the vulnerable "
                    . "software.  Examples of local networks include local IP subnet, Bluetooth, IEEE "
                    . "802.11, and local Ethernet segment.</p><p><b>Network (N)</b> - A vulnerability "
                    . "exploitable with adjacent network access requires the attacker to have access "
                    . "to either the broadcast or collision domain of the vulnerable software.  "
                    . "Examples of local networks include local IP subnet, Bluetooth, IEEE 802.11, and "
                    . "local Ethernet segment.</p>");
                    ?>
                    <td><?php echo $this->escape($avTooltip, 'none')?></td>
                    <td><span style="color:  
                    <?php 
                        echo $this->escape($this->CvssColors('base', 'AV', $this->baseVectorLabels['AV']), 'none')
                    ?>;">
                    <?php echo $this->escape($this->baseVectorLabels['AV'])?></span></td>
                </tr>
                <tr>
                    <?php 
                    $acTooltip = "<p align='center'><b>Access Complexity (AC)</b></p>"
                    . "<p>This metric measures the complexity of the attack required to exploit the "
                    . "vulnerability once an attacker has gained access to the target system. For "
                    . "example, consider a buffer overflow in an Internet service: once the target "
                    . "system is located, the attacker can launch an exploit at will.</p><p>Other "
                    . "vulnerabilities, however, may require additional steps in order to be exploited. " 
                    . "For example, a vulnerability in an email client is only exploited after the user "
                    . "downloads and opens a tainted attachment. The possible values for this metric are " 
                    . "listed below. The lower the required complexity, the higher the vulnerability " 
                    . "score.</p><p><b>High (H)</b> - Specialized access conditions exist. For example: "
                    . "<ul><li>In most configurations, the attacking party must already have "
                    . "elevated privileges or spoof additional systems in addition to the attacking "
                    . "system (e.g., DNS hijacking).<li>The attack depends on social engineering "
                    . "methods that would be easily detected by knowledgeable people. For example, the "
                    . "victim must perform several suspicious or atypical actions.<li>The vulnerable "
                    . "configuration is seen very rarely in practice. <li>If a race condition exists, "
                    . "the window is very narrow.</ul></p><p><b>Medium (M)</b> - The access conditions "
                    . "are somewhat specialized; the following are examples: <ul><li>The attacking party "
                    . "is limited to a group of systems or users at some level of authorization, possibly "
                    . "untrusted. <li>Some information must be gathered before a successful attack can be "
                    . "launched <li>The affected configuration is non-default, and is not commonly "
                    . "configured (e.g., a vulnerability present when a server performs user account "
                    . "authentication via a specific scheme, but not present for another "
                    . "authentication scheme).<li>The attack requires a small amount of social "
                    . "engineering that might occasionally fool cautious users (e.g., phishing attacks "
                    . "that modify a web browsers status bar to show a false link, having to be on "
                    . "someones buddy list before sending an IM exploit).</ul></p><p><b>Low (L)</b> "
                    . "- Specialized access conditions or extenuating circumstances do not exist. The "
                    . "following are examples: <ul><li>The affected product typically requires access "
                    . "to a wide range of systems and users, possibly anonymous and untrusted "
                    . "(e.g., Internet-facing web or mail server).<li>The affected configuration is "
                    . "default or ubiquitous. <li>The attack can be performed manually and requires "
                    . "little skill or additional information gathering. <li>The race condition is a "
                    . "lazy one (i.e., it is technically a race but easily winnable).<ul>";
                    
                    $acYui = "<span id='ACTooltip'"
                    . "class='tooltip'>Access Complexity:</span><script type='text/javascript'>"
                    . "var ACTooltipVar = new YAHOO.widget.Tooltip("
                    . "\"ACTooltipObj\", { context:\"ACTooltip\", "
                    . "showdelay: 150, hidedelay: 150, autodismissdelay: 50000, xyoffset: [100, -250]," 
                    . "text:\"$acTooltip\", "
                    . 'effect:{effect:YAHOO.widget.ContainerEffect.FADE,duration:0.25}, '
                    . 'width: "60%"})</script>';
                    ?>
                    <td><?php echo $this->escape($acYui, 'none')?></td>
                    <td><span style="color:  
                    <?php 
                        echo $this->escape($this->CvssColors('base', 'AC', $this->baseVectorLabels['AC']), 'none')
                    ?>;">
                    <?php echo $this->escape($this->baseVectorLabels['AC'])?></span></td>
                </tr>
                <tr>
                    <?php 
                    $auTooltip = new Fisma_Yui_Tooltip('Au', 'Authentication Values:',
                    "<p align='center'><b>Authentication Values</b></p><p>This metric measures "
                    . "the number of times an attacker must authenticate to a target in order to "
                    . "exploit a vulnerability. This metric does not gauge the strength or complexity "
                    . "of the authentication process, only that an attacker is required to provide "
                    . "credentials before an exploit may occur.  The possible values for this metric "
                    . "are listed below. The fewer authentication instances that are required, "
                    . "the higher the vulnerability score.</p><p><b>Multiple (M)</b> - Exploiting the "
                    . "vulnerability requires that the attacker authenticate two or more times, even "
                    . "if the same credentials are used each time. An example is an attacker "
                    . "authenticating to an operating system in addition to providing credentials to "
                    . "access an application hosted on that system.</p><p><b>Single (S)</b> - The "
                    . "vulnerability requires an attacker to be logged into the system (such as at a "
                    . "command line or via a desktop session or web interface).</p><p><b>None (N)</b> - "
                    . "Authentication is not required to exploit the vulnerability.</p><p>The metric "
                    . "should be applied based on the authentication the attacker requires before "
                    . "launching an attack.  For example, if a mail server is vulnerable to a command "
                    . "that can be issued before a user authenticates, the metric should be scored as "
                    . "'None' because the attacker can launch the exploit before credentials are "
                    . "required.  If the vulnerable command is only available after successful "
                    . "authentication, then the vulnerability should be scored as 'Single' or "
                    . "'Multiple,' depending on how many instances of authentication must occur "
                    . "before issuing the command.</p>");
                    ?>
                    <td><?php echo $this->escape($auTooltip, 'none');?></td>
                    <td><span style="color:  
                    <?php 
                        echo $this->escape($this->CvssColors('base', 'Au', $this->baseVectorLabels['Au']), 'none')
                    ?>;">
                    <?php echo $this->escape($this->baseVectorLabels['Au'])?></span></td>
                </tr>
                <tr>
                    <?php
                    $ciTooltip = new Fisma_Yui_Tooltip('C', 'Confidentiality Impact:',
                    "<p align='center'><b>Confidentiality Impact</b></p><p>This metric measures the "
                    . "impact on confidentiality of a successfully exploited vulnerability. "
                    . "Confidentiality refers to limiting information access and disclosure to only "
                    . "authorized users, as well as preventing access by, or disclosure to, "
                    . "unauthorized ones. The possible values for this metric are listed below. "
                    . "Increased confidentiality impact increases the vulnerability "
                    . "score.</p><p><b>None (N)</b> - There is no impact to the confidentiality of the "
                    . "system.</p><p><b>Partial (P)</b> - There is considerable informational "
                    . "disclosure. Access to some system files is possible, but the attacker does not "
                    . "have control over what is obtained, or the scope of the loss is constrained. An "
                    . "example is a vulnerability that divulges only certain tables in a "
                    . "database.</p><p><b>Complete (C)</b> - There is total information disclosure, "
                    . "resulting in all system files being revealed. The attacker is able to read all "
                    . "of the system's data (memory, files, etc.)</p>");
                    ?>
                    <td><?php echo $this->escape($ciTooltip, 'none')?></td>
                    <td><span style="color:  
                    <?php echo $this->escape($this->CvssColors('base', 'C', $this->baseVectorLabels['C']), 'none')?>;">
                    <?php echo $this->escape($this->baseVectorLabels['C'])?></span></td>
                </tr>
                <tr>
                    <?php
                    $iiTooltip = new Fisma_Yui_Tooltip('I', 'Integrity Impact:', 
                    "<p align='center'><b>Integrity Impact</b></p><p>This metric measures the "
                    . "impact to integrity of a successfully exploited vulnerability. Integrity refers "
                    . "to the trustworthiness and guaranteed veracity of information. The possible "
                    . "values for this metric are listed below. Increased integrity impact "
                    . "increases the vulnerability score.</p><p><b>None (N)</b> - There is no impact "
                    . "to the integrity of the system.</p><p><b>Partial (P)</b> - Modification of some "
                    . "system files or information is possible, but the attacker does not have control "
                    . "over what can be modified, or the scope of what the attacker can affect is "
                    . "limited. For example, system or application files may be overwritten or "
                    . "modified, but either the attacker has no control over which files are affected "
                    . "or the attacker can modify files within only a limited context or "
                    . "scope.</p><p><b>Complete (C)</b> - There is a total compromise of system "
                    . "integrity. There is a complete loss of system protection, resulting in the "
                    . "entire system being compromised. The attacker is able to modify any files on "
                    . "the target system.</p>");
                    ?>
                    <td><?php echo $this->escape($iiTooltip, 'none')?></td>
                    <td><span style="color:  
                    <?php echo $this->escape($this->CvssColors('base', 'I', $this->baseVectorLabels['I']), 'none')?>;">
                    <?php echo $this->escape($this->baseVectorLabels['I'])?></span></td>
                </tr>
                <tr>
                    <?php
                    $aiTooltip = new Fisma_Yui_Tooltip('A', 'Availability Impact:', 
                    "<p align='center'<b>Availability Impact</b></p><p>This metric measures the "
                    . "impact to availability of a successfully exploited vulnerability. Availability "
                    . "refers to the accessibility of information resources. Attacks that consume "
                    . "network bandwidth, processor cycles, or disk space all impact the availability "
                    . "of a system. The possible values for this metric are listed below. Increased "
                    . "availability impact increases the vulnerability score.</p><p><b>None (N)</b> - "
                    . "There is no impact to the availability of the system.</p><p><b>Partial (P)</b> "
                    . "- There is reduced performance or interruptions in resource availability. An "
                    . "example is a network-based flood attack that permits a limited number of "
                    . "successful connections to an Internet service.</p><p><b>Complete (C)</b> - "
                    . "There is a total shutdown of the affected resource. The attacker can render the "
                    . "resource completely unavailable.</p>");
                    ?>
                    <td><?php echo $this->escape($aiTooltip, 'none')?></td>
                    <td><span style="color:  
                    <?php echo $this->escape($this->CvssColors('base', 'A', $this->baseVectorLabels['A']), 'none')?>;">
                    <?php echo $this->escape($this->baseVectorLabels['A'])?></span></td>
                </tr>
           </table>
            
        <br/>
            
        <table class="keyValues">
            <tr>
                <td>CVSS Base Score</td>
                <td><div style="width: 25px; 
                                height: 15px; 
                                vertical-align: middle; 
                                line-height: 1.2em; 
                                text-align: center; 
                                font-weight: bold; 
                                background-color: 
                                <?php echo $this->escape($this->CvssColors('score', null, $this->base), 'none')?>;"> 
                                <?php echo $this->escape($this->base, 'none')?></div></td>
            </tr>
            <tr>
                <td>CVSS Vector</td>
                <td><?php echo $this->escape($this->vector)?></td>
                </td>
            </tr>
        </table>
        <?php Fisma_Format_Section::stopSection(); ?>
    </div>
    <?php else:?>
        <p>No CVSS data found.</p>
<?php endif;?>
