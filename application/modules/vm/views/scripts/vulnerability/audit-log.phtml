<div id="vulnerabilityAuditLog">
    <table id="vulnerabilityAuditLogTable">
        <thead>
            <tr>
                <?php foreach ($this->columns as $column) : ?>
                <th class="tdc"><?php echo $this->escape($column) ?></th>
                <?php endforeach; ?>
            </tr>
        </thead>
        <tbody>
        <?php foreach ($this->rows as $row) : ?>
        <tr>
            <td><?php echo $this->escape($row['o_createdTs']) ?></td>
            <td><?php echo $this->escape($this->userInfo($row['u_username'], null, $row['u_id']), 'none') ?></td>
            <td><?php echo $this->escape($row['o_message'], 'none') ?></td>
        </tr>
        <?php endforeach; ?>
        </tbody>
    </table>
</div>

<?php
    $defs = array();
    $fields = array();
    foreach ($this->columns as $column) {
        $defs[] = "{key:'$column', label:'$column', sortable:true, formatter: 'html'}";
        $fields[] = "{key:'$column'}";
    }
    $defs = implode(',', $defs);
    $fields = implode(',', $fields);
?>
<script type="text/javascript">
// Convert the HTML table above into a YUI table
YAHOO.util.Event.onContentReady('vulnerabilityAuditLog', function() {
    var myColumnDefs = [<?php echo $this->escape($defs, 'none')?>];

    this.myDataSource = new YAHOO.util.DataSource(YAHOO.util.Dom.get("vulnerabilityAuditLogTable"));
    this.myDataSource.responseType = YAHOO.util.DataSource.TYPE_HTMLTABLE;
    this.myDataSource.responseSchema = {
        fields: [<?php echo $this->escape($fields, 'none')?>]
    };

    this.myDataTable = new YAHOO.widget.DataTable("vulnerabilityAuditLog", myColumnDefs, this.myDataSource, {});
});
</script>
