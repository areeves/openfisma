<div class="searchBox">
    <div class="left">
        <?php
        foreach ($this->toolbarButtons as $button):
            echo $this->escape($button, 'none');
        endforeach;
        ?>
    </div>
    
    <?php if(isset($this->searchForm)): ?>
        <div class="right">
            <?php
            echo $this->escape($this->searchForm, 'none');
            ?>
        </div>
    <?php endif; ?>

    <div class="clear"></div>
</div>

<div id="moreSearchOptions" class="searchBox searchBoxAdditional" style="display: none;">
    <p>More Search Options:</p>
    <div class="centerButtons">
        <?php 
        if (isset($this->searchMoreOptionsForm)):
            echo $this->escape($this->searchMoreOptionsForm, 'none'); 
        endif;
        ?>
    </div>
</div>

<div id="searchColumns" class="searchBox searchBoxAdditional" style="display: none;">
    <p>Toggle Column Visibility:</p>
    <div id="searchColumnsButtons" class="centerButtons"></div>
</div>

<div id="advancedSearch" class="searchBox searchBoxAdditional"  style="display: none;">
    <p>Advanced Search:</p>
    <div id="advancedSearchCriteria"></div>
</div>

<?php if (isset($this->advancedSearchOptions)): ?>
    <script>
        (function() {
            var Dom = YAHOO.util.Dom,
                Lang = YAHOO.lang;
            function pollDT() {
                if (Lang.isObject(Fisma.Search.yuiDataTable)) {
                    Fisma.Search.initializeSearchColumnsPanel(Dom.get("searchColumnsButtons"));
                } else {
                    Lang.later(0, pollDT, pollDT);
                }
            }
            pollDT();
        })();

        YAHOO.util.Event.onContentReady (
            "advancedSearch", 
            function () {
                var advancedSearchOptions = <?php echo $this->escape($this->advancedSearchOptions, 'none'); ?>;

                var searchPanel = new Fisma.Search.Panel(advancedSearchOptions, document.location.pathname);
            
                Fisma.Search.advancedSearchPanel = searchPanel;

                searchPanel.render(document.getElementById('advancedSearchCriteria'));
            }
        );
    </script>
<?php endif; ?>
